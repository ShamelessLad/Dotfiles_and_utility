chrome.runtime.onInstalled.addListener(function(a){function b(a){storage.area.get(function(b){var d,c=storage.default_options,e={};for(d in c)b.hasOwnProperty(d)||(e[d]=c[d]);0!==Object.keys(e).length?storage.area.set(e,function(){"function"==typeof a&&a()}):"function"==typeof a&&a()})}switch(a.reason){case"install":var c=navigator.userAgent;localStorage.browser=-1===c.indexOf("OPR/")?"chrome":"opera",b(function(){chrome.tabs.create({url:"options.html#help"})});break;case"update":b()}}),chrome.runtime.onUpdateAvailable.addListener(function(a){chrome.runtime.reload()}),chrome.runtime.onMessage.addListener(function(a,b,c){switch(a.msg){case"openLinksInNewWindow":chrome.windows.create({type:"normal",focused:!0},function(b){a.links.forEach(function(a){chrome.tabs.create({windowId:b.id,url:a.url,pinned:a.pinned})}),chrome.tabs.remove(b.tabs[0].id)});break;case"openLinksInCurrentWindow":a.links.forEach(function(a){chrome.tabs.create({url:a.url,pinned:a.pinned})});break;case"openWindowLinksInCurrentWindow":a.links.forEach(function(b){b.windowId===parseInt(a.window_id,10)&&chrome.tabs.create({url:b.url,pinned:b.pinned})})}}),storage.area.get("session_watcher",function(a){a.session_watcher&&!function(){function c(){chrome.tabs.query({},function(a){var c={name:"",tabs:[]},d={};a.forEach(function(a){var b={};0!==a.url.indexOf("chrome-devtools://")&&(b.pinned=a.pinned,b.title=a.title,b.url=a.url,b.windowId=a.windowId,c.tabs.push(b))}),d[b]=c,chrome.storage.local.set(d)})}var a={session_numbers:30,prefix:"tg_"},b=a.prefix+(new Date).getTime();localStorage.session_id=b,chrome.storage.local.get(function(b){var c=function(){var c,d;for(c in b)if(0===c.indexOf(a.prefix)){d=c;break}return d?d.slice(a.prefix.length):d}(),d=Object.keys(b);c&&d.length>=a.session_numbers&&(d.forEach(function(b){var d=b.slice(a.prefix.length);c=c>d?d:c}),chrome.storage.local.remove(a.prefix+c))}),chrome.tabs.onUpdated.addListener(function(a,b){b.url&&c()}),chrome.tabs.onMoved.addListener(function(){c()}),chrome.tabs.onAttached.addListener(function(){c()}),chrome.tabs.onRemoved.addListener(function(){c()}),chrome.tabs.onReplaced.addListener(function(){c()}),c()}()});